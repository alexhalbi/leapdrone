/*    
 * LeapJS-Plugins  - v0.1.8 - 2014-10-07    
 * http://github.com/leapmotion/leapjs-plugins/    
 *    
 * Copyright 2014 LeapMotion, Inc    
 *    
 * Licensed under the Apache License, Version 2.0 (the "License");    
 * you may not use this file except in compliance with the License.    
 * You may obtain a copy of the License at    
 *    
 *     http://www.apache.org/licenses/LICENSE-2.0    
 *    
 * Unless required by applicable law or agreed to in writing, software    
 * distributed under the License is distributed on an "AS IS" BASIS,    
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.    
 * See the License for the specific language governing permissions and    
 * limitations under the License.    
 *    
 */    
(function(){var a;if(a=function(){var a;return a=[],0===Leap.version.major&&Leap.version.minor<5&&console.warn("The hand entry plugin requires LeapJS 0.5.0 or newer."),this.on("deviceStopped",function(){for(var b=0,c=a.length;c>b;b++)id=a[b],a.splice(b,1),this.emit("handLost",this.lastConnectionFrame.hand(id)),b--,c--}),{frame:function(b){var c,d,e,f,g;d=b.hands.map(function(a){return a.id});for(var h=0,i=a.length;i>h;h++)c=a[h],-1==d.indexOf(c)&&(a.splice(h,1),this.emit("handLost",this.frame(1).hand(c)),h--,i--);for(g=[],e=0,f=d.length;f>e;e++)c=d[e],-1===a.indexOf(c)?(a.push(c),g.push(this.emit("handFound",b.hand(c)))):g.push(void 0);return g}}},"undefined"!=typeof Leap&&Leap.Controller)Leap.Controller.plugin("handEntry",a);else{if("undefined"==typeof module)throw"leap.js not included";module.exports.handEntry=a}}).call(this),function(){var a;if(a=function(){var a,b;return b={},a=function(a,c,d){var e,f,g,h;if(b[g=a+this.id]||(b[g]=[]),e=b[a+this.id],void 0!==d)return e[c]=d;if("[object String]"==={}.toString.call(c))return e[c];h=[];for(f in c)d=c[f],h.push(void 0===d?delete e[f]:e[f]=d);return h},{hand:{data:function(b,c){return a.call(this,"h",b,c)},hold:function(a){return a?this.data({holding:a}):this.hold(this.hovering())},holding:function(){return this.data("holding")},release:function(){var a;return a=this.data("holding"),this.data({holding:void 0}),a},hoverFn:function(a){return this.data({getHover:a})},hovering:function(){var a;return(a=this.data("getHover"))?this._hovering||(this._hovering=a.call(this)):void 0}},pointable:{data:function(b,c){return a.call(this,"p",b,c)}}}},"undefined"!=typeof Leap&&Leap.Controller)Leap.Controller.plugin("handHold",a);else{if("undefined"==typeof module)throw"leap.js not included";module.exports.handHold=a}}.call(this),function(a,b){"use strict";function c(a){this.options=a||(a={}),this.loading=!1,this.timeBetweenLoops=a.timeBetweenLoops||50,this.packingStructure=["id","timestamp",{hands:[["id","type","direction","palmNormal","palmPosition","palmVelocity","stabilizedPalmPosition","pinchStrength","grabStrength","confidence"]]},{pointables:[["id","direction","handId","length","stabilizedTipPosition","tipPosition","tipVelocity","tool","carpPosition","mcpPosition","pipPosition","dipPosition","btipPosition","bases","type"]]},{interactionBox:["center","size"]}],this.setFrames(a.frames||[])}var d={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(a){if(null==a)return"";var b,c,e,f,g,h,i,j="",k=0;for(a=d.compress(a);k<2*a.length;)k%2==0?(b=a.charCodeAt(k/2)>>8,c=255&a.charCodeAt(k/2),e=k/2+1<a.length?a.charCodeAt(k/2+1)>>8:0/0):(b=255&a.charCodeAt((k-1)/2),(k+1)/2<a.length?(c=a.charCodeAt((k+1)/2)>>8,e=255&a.charCodeAt((k+1)/2)):c=e=0/0),k+=3,f=b>>2,g=(3&b)<<4|c>>4,h=(15&c)<<2|e>>6,i=63&e,isNaN(c)?h=i=64:isNaN(e)&&(i=64),j=j+d._keyStr.charAt(f)+d._keyStr.charAt(g)+d._keyStr.charAt(h)+d._keyStr.charAt(i);return j},decompressFromBase64:function(a){if(null==a)return"";var b,c,e,f,g,h,i,j,k="",l=0,m=0,n=d._f;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");m<a.length;)g=d._keyStr.indexOf(a.charAt(m++)),h=d._keyStr.indexOf(a.charAt(m++)),i=d._keyStr.indexOf(a.charAt(m++)),j=d._keyStr.indexOf(a.charAt(m++)),c=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,l%2==0?(b=c<<8,64!=i&&(k+=n(b|e)),64!=j&&(b=f<<8)):(k+=n(b|c),64!=i&&(b=e<<8),64!=j&&(k+=n(b|f))),l+=3;return d.decompress(k)},compressToUTF16:function(a){if(null==a)return"";var b,c,e,f="",g=0,h=d._f;for(a=d.compress(a),b=0;b<a.length;b++)switch(c=a.charCodeAt(b),g++){case 0:f+=h((c>>1)+32),e=(1&c)<<14;break;case 1:f+=h(e+(c>>2)+32),e=(3&c)<<13;break;case 2:f+=h(e+(c>>3)+32),e=(7&c)<<12;break;case 3:f+=h(e+(c>>4)+32),e=(15&c)<<11;break;case 4:f+=h(e+(c>>5)+32),e=(31&c)<<10;break;case 5:f+=h(e+(c>>6)+32),e=(63&c)<<9;break;case 6:f+=h(e+(c>>7)+32),e=(127&c)<<8;break;case 7:f+=h(e+(c>>8)+32),e=(255&c)<<7;break;case 8:f+=h(e+(c>>9)+32),e=(511&c)<<6;break;case 9:f+=h(e+(c>>10)+32),e=(1023&c)<<5;break;case 10:f+=h(e+(c>>11)+32),e=(2047&c)<<4;break;case 11:f+=h(e+(c>>12)+32),e=(4095&c)<<3;break;case 12:f+=h(e+(c>>13)+32),e=(8191&c)<<2;break;case 13:f+=h(e+(c>>14)+32),e=(16383&c)<<1;break;case 14:f+=h(e+(c>>15)+32,(32767&c)+32),g=0}return f+h(e+32)},decompressFromUTF16:function(a){if(null==a)return"";for(var b,c,e="",f=0,g=0,h=d._f;g<a.length;){switch(c=a.charCodeAt(g)-32,f++){case 0:b=c<<1;break;case 1:e+=h(b|c>>14),b=(16383&c)<<2;break;case 2:e+=h(b|c>>13),b=(8191&c)<<3;break;case 3:e+=h(b|c>>12),b=(4095&c)<<4;break;case 4:e+=h(b|c>>11),b=(2047&c)<<5;break;case 5:e+=h(b|c>>10),b=(1023&c)<<6;break;case 6:e+=h(b|c>>9),b=(511&c)<<7;break;case 7:e+=h(b|c>>8),b=(255&c)<<8;break;case 8:e+=h(b|c>>7),b=(127&c)<<9;break;case 9:e+=h(b|c>>6),b=(63&c)<<10;break;case 10:e+=h(b|c>>5),b=(31&c)<<11;break;case 11:e+=h(b|c>>4),b=(15&c)<<12;break;case 12:e+=h(b|c>>3),b=(7&c)<<13;break;case 13:e+=h(b|c>>2),b=(3&c)<<14;break;case 14:e+=h(b|c>>1),b=(1&c)<<15;break;case 15:e+=h(b|c),f=0}g++}return d.decompress(e)},compress:function(a){if(null==a)return"";var b,c,e,f={},g={},h="",i="",j="",k=2,l=3,m=2,n="",o=0,p=0,q=d._f;for(e=0;e<a.length;e+=1)if(h=a.charAt(e),Object.prototype.hasOwnProperty.call(f,h)||(f[h]=l++,g[h]=!0),i=j+h,Object.prototype.hasOwnProperty.call(f,i))j=i;else{if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(b=0;m>b;b++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(c=j.charCodeAt(0),b=0;8>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1}else{for(c=1,b=0;m>b;b++)o=o<<1|c,15==p?(p=0,n+=q(o),o=0):p++,c=0;for(c=j.charCodeAt(0),b=0;16>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(c=f[j],b=0;m>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1;k--,0==k&&(k=Math.pow(2,m),m++),f[i]=l++,j=String(h)}if(""!==j){if(Object.prototype.hasOwnProperty.call(g,j)){if(j.charCodeAt(0)<256){for(b=0;m>b;b++)o<<=1,15==p?(p=0,n+=q(o),o=0):p++;for(c=j.charCodeAt(0),b=0;8>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1}else{for(c=1,b=0;m>b;b++)o=o<<1|c,15==p?(p=0,n+=q(o),o=0):p++,c=0;for(c=j.charCodeAt(0),b=0;16>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1}k--,0==k&&(k=Math.pow(2,m),m++),delete g[j]}else for(c=f[j],b=0;m>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1;k--,0==k&&(k=Math.pow(2,m),m++)}for(c=2,b=0;m>b;b++)o=o<<1|1&c,15==p?(p=0,n+=q(o),o=0):p++,c>>=1;for(;;){if(o<<=1,15==p){n+=q(o);break}p++}return n},decompress:function(a){if(null==a)return"";if(""==a)return null;var b,c,e,f,g,h,i,j,k=[],l=4,m=4,n=3,o="",p="",q=d._f,r={string:a,val:a.charCodeAt(0),position:32768,index:1};for(c=0;3>c;c+=1)k[c]=c;for(f=0,h=Math.pow(2,2),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;switch(b=f){case 0:for(f=0,h=Math.pow(2,8),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;j=q(f);break;case 1:for(f=0,h=Math.pow(2,16),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;j=q(f);break;case 2:return""}for(k[3]=j,e=p=j;;){if(r.index>r.string.length)return"";for(f=0,h=Math.pow(2,n),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;switch(j=f){case 0:for(f=0,h=Math.pow(2,8),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;k[m++]=q(f),j=m-1,l--;break;case 1:for(f=0,h=Math.pow(2,16),i=1;i!=h;)g=r.val&r.position,r.position>>=1,0==r.position&&(r.position=32768,r.val=r.string.charCodeAt(r.index++)),f|=(g>0?1:0)*i,i<<=1;k[m++]=q(f),j=m-1,l--;break;case 2:return p}if(0==l&&(l=Math.pow(2,n),n++),k[j])o=k[j];else{if(j!==m)return null;o=e+e.charAt(0)}p+=o,k[m++]=e+o.charAt(0),l--,e=o,0==l&&(l=Math.pow(2,n),n++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=d),function(){if("undefined"==typeof a.performance&&(a.performance={}),!a.performance.now){var b=Date.now();performance.timing&&performance.timing.navigationStart&&(b=performance.timing.navigationStart),a.performance.now=function(){return Date.now()-b}}}(),c.prototype={setFrames:function(a){this.frameData=a,this.frameIndex=0,this.frameCount=a.length,this.leftCropPosition=0,this.rightCropPosition=this.frameCount,this.setMetaData()},addFrame:function(a){this.frameData.push(a)},currentFrame:function(){return this.frameData[this.frameIndex]},nextFrame:function(){var a=this.frameIndex+1;return a%=this.rightCropPosition||1,a<this.leftCropPosition&&(a=this.leftCropPosition),this.frameData[a]},advanceFrame:function(){return this.frameIndex++,this.frameIndex>=this.rightCropPosition&&!this.options.loop?(this.frameIndex--,!1):(this.frameIndex=this.frameIndex%(this.rightCropPosition||1),this.frameIndex<this.leftCropPosition&&(this.frameIndex=this.leftCropPosition),!0)},readyPlay:function(){this.frameIndex++,this.frameIndex>=this.rightCropPosition?(this.frameIndex=this.frameIndex%(this.rightCropPosition||1),this.frameIndex<this.leftCropPosition&&(this.frameIndex=this.leftCropPosition)):this.frameIndex--},cloneCurrentFrame:function(){return JSON.parse(JSON.stringify(this.currentFrame()))},createLerpFrameData:function(a){for(var b,c,d,e=this.currentFrame(),f=this.nextFrame(),g=["palmPosition","stabilizedPalmPosition","sphereCenter","direction","palmNormal","palmVelocity"],h=["mcpPosition","pipPosition","dipPosition","tipPosition","direction"],i=this.cloneCurrentFrame(),j=i.hands.length,k=i.pointables.length,l=g.length,m=h.length,n=0;j>n;n++){c=i.hands[n];for(var o=0;l>o;o++)b=g[o],e.hands[n][b]&&f.hands[n]&&(Leap.vec3.lerp(c[b],e.hands[n][b],f.hands[n][b],a),console.assert(c[b]))}for(n=0;k>n;n++)for(d=i.pointables[n],o=0;m>o;o++)b=h[o],e.pointables[n][b]&&f.hands[n]&&Leap.vec3.lerp(d[b],e.pointables[n][b],f.pointables[n][b],0);return i},timeToNextFrame:function(){var a=(this.nextFrame().timestamp-this.currentFrame().timestamp)/1e3;return 0>a&&(a=this.timeBetweenLoops),console.assert(!isNaN(a)),a},blank:function(){return 0===this.frameData.length},leftCrop:function(){this.leftCropPosition=this.frameIndex},rightCrop:function(){this.rightCropPosition=this.frameIndex},cullFrames:function(a){console.log("cull frames",a),a||(a=1);for(var b=0;b<this.frameData.length;b++)this.frameData.splice(b,a);this.setMetaData()},frameRate:function(){return 0==this.frameData.length?0:this.frameData.length/(this.frameData[this.frameData.length-1].timestamp-this.frameData[0].timestamp)*1e6},croppedFrameData:function(){return this.frameData.slice(this.leftCropPosition,this.rightCropPosition)},setMetaData:function(){var a={formatVersion:2,generatedBy:"LeapJS Playback 0.2.0",frames:this.rightCropPosition-this.leftCropPosition,protocolVersion:this.options.requestProtocolVersion,serviceVersion:this.options.serviceVersion,frameRate:this.frameRate().toPrecision(2),modified:(new Date).toString()};this.metadata||(this.metadata={});for(var b in a)this.metadata[b]=a[b]},packedFrameData:function(){var a,b=this.croppedFrameData(),c=[];c.push(this.packingStructure);for(var d=0,e=b.length;e>d;d++)a=b[d],c.push(this.packArray(this.packingStructure,a));return c},packArray:function(a,b){for(var c,d=[],e=0,f=a.length;f>e;e++)if(c=a[e],"string"==typeof c)d.push(b[c]);else if("[object Array]"==Object.prototype.toString.call(c))for(var g=0,h=b.length;h>g;g++)d.push(this.packArray(c,b[g]));else{console.assert(c);for(var i in c)break;console.assert(i),console.assert(c[i]),console.assert(b[i]),d.push(this.packArray(c[i],b[i]))}return d},unPackFrameData:function(a){for(var b,c=a[0],d=[],e=1,f=a.length;f>e;e++)b=a[e],d.push(this.unPackArray(c,b));return d},unPackArray:function(a,b){for(var c,d={},e=0,f=a.length;f>e;e++)if(c=a[e],"string"==typeof c)d[c]=b[e];else{if("[object Array]"==Object.prototype.toString.call(c)){for(var g=[],h=0,i=b.length;i>h;h++)g.push(this.unPackArray(c,b[h]));return g}for(var j in c)break;d[j]=this.unPackArray(c[j],b[e])}return d},toHash:function(){return this.setMetaData(),{metadata:this.metadata,frames:this.packedFrameData()}},"export":function(a){var b=JSON.stringify(this.toHash());return"json"==a?b:d.compressToBase64(b)},save:function(a){var b;b=this.metadata.title?this.metadata.title.replace(/\s/g,""):"leap-playback-recording",this.metadata.frameRate&&(b+="-"+Math.round(this.metadata.frameRate)+"fps"),"json"===a?saveAs(new Blob([this.export("json")],{type:"text/JSON;charset=utf-8"}),b+".json"):saveAs(new Blob([this.export("lz")],{type:"application/x-gzip;charset=utf-8"}),b+".json.lz")},decompress:function(a){return d.decompressFromBase64(a)},loaded:function(){return!(!this.frameData||!this.frameData.length)},loadFrameData:function(a){var b=new XMLHttpRequest,c=this.url,d=this;b.onreadystatechange=function(){b.readyState===b.DONE&&(200===b.status||0===b.status?b.responseText?d.finishLoad(b.responseText,a):console.error('Leap Playback: "'+c+'" seems to be unreachable or the file is empty.'):console.error("Leap Playback: Couldn't load \""+c+'" ('+b.status+")"))},b.addEventListener("progress",function(a){if(d.options.loadProgress&&a.lengthComputable){var b=a.loaded/a.total;d.options.loadProgress(d,b,a)}}),this.loading=!0,b.open("GET",c,!0),b.send(null)},finishLoad:function(a,b){var c=this.url;"lz"==c.split(".")[c.split(".").length-1]&&(a=this.decompress(a)),a=JSON.parse(a),2==a.metadata.formatVersion&&(a.frames=this.unPackFrameData(a.frames)),this.metadata=a.metadata,console.log("Recording loaded:",this.metadata),this.loading=!1,b&&b.call(this,a.frames)}},function(){function d(a,b){var c=this;b||(b={}),this.options=b,this.recording=b.recording,this.controller=a,this.resetTimers(),this.setupLoops(),this.controller.connection.on("ready",function(){c.setupProtocols()}),this.userHasControl=!1,b.recording&&("[object String]"==Object.prototype.toString.call(b.recording)&&(b.recording={url:b.recording}),this.setRecording(b.recording)),document.addEventListener("DOMContentLoaded",function(){document.body.addEventListener("keydown",function(a){a.which===c.options.pauseHotkey&&c.toggle()},!1)})}var e='',f='';
d.prototype={resetTimers:function(){this.timeSinceLastFrame=0,this.lastFrameTime=null},setupLoops:function(){var a=this;this.stepFrameLoop=function(b){"playing"==a.state&&(a.sendFrameAt(b||performance.now()),requestAnimationFrame(a.stepFrameLoop))}},setupProtocols:function(){var a=this;this.stopProtocol=this.controller.connection.protocol,this.playbackProtocol=function(b){var c=a.stopProtocol(b);return c instanceof Leap.Frame?(a.pauseOnHand&&(b.hands.length>0?(a.userHasControl=!0,a.controller.emit("playback.userTakeControl"),a.setGraphic(),a.idle()):0==b.hands.length&&a.userHasControl&&a.resumeOnHandLost&&(a.userHasControl=!1,a.controller.emit("playback.userReleaseControl"),a.setGraphic("wave"))),{type:"playback"}):c},this.recordProtocol=function(b){var c=a.stopProtocol(b);return c instanceof Leap.Frame&&a.recordFrameHandler(b),c};for(var b in this.stopProtocol)this.stopProtocol.hasOwnProperty(b)&&(this.playbackProtocol[b]=this.stopProtocol[b],this.recordProtocol[b]=this.stopProtocol[b]);"playing"==this.state&&(this.controller.connection.protocol=this.playbackProtocol)},sendFrameAt:function(a){this.lastFrameTime&&(a<this.lastFrameTime?this.lastFrameTime=a:this.timeSinceLastFrame+=a-this.lastFrameTime),this.lastFrameTime=a,console.assert(!isNaN(this.timeSinceLastFrame));for(var b;this.timeSinceLastFrame>(b=this.recording.timeToNextFrame());)if(this.timeSinceLastFrame-=b,!this.recording.advanceFrame())return this.pause(),void this.controller.emit("playback.playbackFinished",this);this.sendFrame(this.recording.createLerpFrameData(this.timeSinceLastFrame/b))},sendFrame:function(a){if(!a)throw"Frame data not provided";var b=new Leap.Frame(a);return this.controller.processFrame(b),!0},sendImmediateFrame:function(a){if(!a)throw"Frame data not provided";var b=new Leap.Frame(a);return this.controller.processFinishedFrame(b),!0},setFrameIndex:function(a){a!=this.recording.frameIndex&&(this.recording.frameIndex=a%this.recording.frameCount,this.sendFrame(this.recording.currentFrame()))},stop:function(){this.idle(),delete this.recording,this.recording=new c({timeBetweenLoops:this.options.timeBetweenLoops,loop:this.options.loop,requestProtocolVersion:this.controller.connection.opts.requestProtocolVersion,serviceVersion:this.controller.connection.protocol.serviceVersion}),this.controller.emit("playback.stop",this)},pause:function(){this.state="idle",this.hideOverlay(),this.controller.emit("playback.pause",this)},idle:function(){this.state="idle",this.controller.connection.protocol=this.stopProtocol},toggle:function(){"idle"==this.state?this.play():"playing"==this.state&&this.pause()},record:function(){this.clear(),this.stop(),this.state="recording",this.controller.connection.protocol=this.recordProtocol,this.setGraphic("connect"),this.controller.emit("playback.record",this)},clear:function(){if(this.recording&&!this.recording.blank()){var a=this.recording.cloneCurrentFrame();a.hands=[],a.fingers=[],a.pointables=[],a.tools=[],this.sendImmediateFrame(a)}},recordPending:function(){return"recording"==this.state&&this.recording.blank()},isRecording:function(){return"recording"==this.state&&!this.recording.blank()},finishRecording:function(){this.controller.connection.protocol=this.playbackProtocol,this.recording.setFrames(this.recording.frameData),this.controller.emit("playback.recordingFinished",this)},loaded:function(){return this.recording.loaded()},loading:function(){return this.recording.loading},play:function(){if("playing"!==this.state&&!this.loading()&&!this.recording.blank()){this.state="playing",this.controller.connection.protocol=this.playbackProtocol;var a=this;this.controller.connection.removeAllListeners("frame"),this.controller.connection.on("frame",function(b){a.resumeOnHandLost&&a.autoPlay&&"idle"==a.state&&0==b.hands.length&&a.play(),a.controller.processFrame(b)}),this.resetTimers(),this.recording.readyPlay(),this.stepFrameLoop(),this.controller.emit("playback.play",this)}},recordFrameHandler:function(a){this.setGraphic("wave"),a.hands.length>0?(this.recording.addFrame(a),this.hideOverlay()):this.recording.blank()||this.finishRecording()},setRecording:function(a){var b=this;this.pause();var d=function(a){return this.setFrames(a),b.recording!=this?void console.log("recordings changed during load"):(b.autoPlay&&(b.play(),b.pauseOnHand&&!b.controller.streaming()&&b.setGraphic("connect")),void b.controller.emit("playback.recordingSet",this))};return this.recording=a,a instanceof c||(this.recording.__proto__=c.prototype,c.call(this.recording,{timeBetweenLoops:this.options.timeBetweenLoops,loop:this.options.loop,loadProgress:function(a,c,d){b.controller.emit("playback.ajax:progress",a,c,d)}})),this.recording.loaded()?d.call(this.recording,this.recording.frameData):a.url&&(this.controller.emit("playback.ajax:begin",this,this.recording),this.recording.loadFrameData(function(a){d.call(this,a),b.controller.emit("playback.ajax:complete",b,this)})),this},hideOverlay:function(){this.overlay&&(this.overlay.style.display="none")},setGraphic:function(a){if(this.overlay&&this.graphicName!=a)switch(this.graphicName=a,a){case"connect":this.overlay.style.display="block",this.overlay.innerHTML=e;break;case"wave":this.overlay.style.display="block",this.overlay.innerHTML=f;break;case b:this.overlay.innerHTML=""}}};var g=function(c){var e=this,f=c.autoPlay;f===b&&(f=!0);var g=c.pauseOnHand;g===b&&(g=!0);var h=c.resumeOnHandLost;h===b&&(h=!0);var i=c.timeBetweenLoops;i===b&&(i=50);var j=c.requiredProtocolVersion,k=c.pauseHotkey;k===b&&(k=32);var l=c.loop;l===b&&(l=!0);var m=c.overlay;m===b&&document.body&&(m=document.createElement("div"),document.body.appendChild(m),m.style.width="0%",m.style.position="absolute",m.style.top="0",m.style.left="-"+a.getComputedStyle(document.body).getPropertyValue("margin"),m.style.padding="10px",m.style.textAlign="center",m.style.fontSize="18px",m.style.opacity="0.8",m.style.display="none",m.style.zIndex="10",m.id="connect-leap",m.style.cursor="pointer",m.addEventListener("click",function(){return this.style.display="none",!1},!1)),c.player=new d(this,{recording:c.recording,loop:l,pauseHotkey:k,timeBetweenLoops:i}),c.player.overlay=m,c.player.pauseOnHand=g,c.player.resumeOnHandLost=h,c.player.requiredProtocolVersion=j,c.player.autoPlay=f;var n=function(){return c.player.pauseOnHand&&e.connection.opts.requestProtocolVersion<c.requiredProtocolVersion?(console.log("Protocol Version too old ("+e.connection.opts.requestProtocolVersion+"), disabling device interaction."),void(c.player.pauseOnHand=!1)):(f&&(e.on("streamingStarted",function(){"recording"==c.player.state?(c.player.pause(),c.player.setGraphic("wave")):g?c.player.setGraphic("wave"):c.player.setGraphic()}),e.on("streamingStopped",function(){c.player.play()})),void e.on("streamingStopped",function(){c.player.setGraphic("connect")}))};return this.connection.connected?n():this.on("ready",n),{}};if("undefined"!=typeof Leap&&Leap.Controller)Leap.Controller.plugin("playback",g);else{if("undefined"==typeof module)throw"leap.js not included";module.exports.playback=g}}.call(this)}(window),function(){var a;if(a=function(a){var b,c,d,e;return null==a&&(a={}),a.positioning||(a.positioning="absolute"),a.scale||(a.scale=1),a.scaleX||(a.scaleX=1),a.scaleY||(a.scaleY=1),a.scaleZ||(a.scaleZ=1),a.verticalOffset||(a.verticalOffset=0),b=6,c=-100,e={absolute:function(d){return[window.innerWidth/2+d[0]*b*a.scale*a.scaleX,window.innerHeight+c+a.verticalOffset-d[1]*b*a.scale*a.scaleY,d[2]*b*a.scale*a.scaleZ]}},d=function(b,c){var d;return null==c&&(c=!1),d="function"==typeof a.positioning?a.positioning.call(this,b):e[a.positioning].call(this,b),c&&(this.screenPositionVec3=d),d},{hand:{screenPosition:function(a){return d.call(this,a||this.palmPosition,!a)}},pointable:{screenPosition:function(a){return d.call(this,a||this.tipPosition,!a)}}}},"undefined"!=typeof Leap&&Leap.Controller)Leap.Controller.plugin("screenPosition",a);else{if("undefined"==typeof module)throw"leap.js not included";module.exports.screenPosition=a}}.call(this),function(){var a=[].slice;Leap.plugin("transform",function(b){var c,d,e,f,g;return null==b&&(b={}),c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g=new THREE.Matrix4,b.getMatrix=function(a){var d;return b.transform?(d="function"==typeof b.transform?b.transform(a):b.transform,window.THREE&&d instanceof THREE.Matrix4?d.elements:d):b.position||b.quaternion||b.scale?(g.set.apply(g,c),b.quaternion&&g.makeRotationFromQuaternion("function"==typeof b.quaternion?b.quaternion(a):b.quaternion),b.scale&&g.scale("function"==typeof b.scale?b.scale(a):b.scale),b.position&&g.setPosition("function"==typeof b.position?b.position(a):b.position),g.elements):c},f=function(){var b,c,d,e,f,g;for(b=arguments[0],d=2<=arguments.length?a.call(arguments,1):[],g=[],e=0,f=d.length;f>e;e++)c=d[e],g.push(c?Leap.vec3.transformMat4(c,c,b):void 0);return g},e=function(a,b,c){var d,e,f;return d=b[0],e=b[1],f=b[2],a[0]=c[0]*d+c[4]*e+c[8]*f,a[1]=c[1]*d+c[5]*e+c[9]*f,a[2]=c[2]*d+c[6]*e+c[10]*f,a},d=function(){var b,c,d,f,g,h;for(b=arguments[0],d=2<=arguments.length?a.call(arguments,1):[],h=[],f=0,g=d.length;g>f;f++)c=d[f],h.push(c?e(c,c,b):void 0);return h},{hand:function(a){var c,e,g,h,i,j;for(e=b.getMatrix(a),f(e,a.palmPosition,a.stabilizedPalmPosition,a.sphereCenter),d(e,a.direction,a.palmNormal,a.palmVelocity),i=a.fingers,j=[],g=0,h=i.length;h>g;g++)c=i[g],f(e,c.carpPosition,c.mcpPosition,c.pipPosition,c.dipPosition,c.distal.nextJoint,c.tipPosition),j.push(d(e,c.direction));return j}}})}.call(this),function(){var a;if(a=function(a){return a.alert||(a.alert=!1),a.requiredProtocolVersion||(a.requiredProtocolVersion=6),a.disconnect||(a.disconnect=!0),"undefined"!=typeof Leap&&Leap.Controller&&Leap.version.minor<5&&Leap.version.dot<4&&console.warn("LeapJS Version Check plugin incompatible with LeapJS pre 0.4.4"),this.on("ready",function(){var b,c,d;return d=a.requiredProtocolVersion,b=this.connection.opts.requestProtocolVersion,d>b?(c="Protocol Version too old. v"+d+" required, v"+b+" available.",a.disconnect&&(this.disconnect(),c+=" Disconnecting."),console.warn(c),a.alert&&alert("Your Leap Software version is out of date.  Visit http://www.leapmotion.com/setup to update"),this.emit("versionCheck.outdated",{required:d,current:b,disconnect:a.disconnect})):void 0}),{}},"undefined"!=typeof Leap&&Leap.Controller)Leap.Controller.plugin("versionCheck",a);else{if("undefined"==typeof module)throw"leap.js not included";module.exports.versionCheck=a}}.call(this);